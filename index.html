<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>University GPA & CGPA Report Generator</title>
<style>
  body {
    font-family: "Times New Roman", serif;
    background: #f5f7fa;
    margin: 0;
    padding: 20px;
  }

  h2, h3 {
    text-align: center;
    color: #1a237e;
    text-transform: uppercase;
  }

  .toggle-btn, button, .nav-btn {
    background-color: #1a237e;
    color: white;
    border: none;
    border-radius: 6px;
    padding: 8px 16px;
    margin: 10px;
    cursor: pointer;
    transition: 0.3s;
    font-size: 1em;
  }

  .toggle-btn:hover, button:hover, .nav-btn:hover {
    background-color: #0d154d;
  }
  
  .nav-container {
    text-align: center;
    margin-bottom: 20px;
  }

  input, select {
    margin: 5px;
    padding: 7px;
    border-radius: 4px;
    border: 1px solid #aaa;
    width: 90%;
    max-width: 250px; /* Limit width */
  }

  .grade-chart {
    display: none;
    background: white;
    border-radius: 10px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
    padding: 15px;
    margin: 20px auto;
    max-width: 550px;
  }

  .grade-chart table {
    width: 100%;
    border-collapse: collapse;
    text-align: center;
  }
  .grade-chart th, .grade-chart td {
    border: 1px solid #444;
    padding: 6px;
  }
  .grade-chart th {
    background: #1a237e;
    color: white;
  }

  .student-box, .cgpa-box {
    background: #fff;
    border-radius: 10px;
    padding: 20px;
    margin: 15px 0;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
  }

  .course-box, .semester-box {
    background: #fafafa;
    border-left: 4px solid #1a237e;
    padding: 10px;
    margin: 8px 0;
    border-radius: 4px;
  }

  .gpa, .cgpa-result {
    font-weight: bold;
    color: #1a237e;
    font-size: 1.2em;
    text-align: center;
    margin-top: 15px;
  }

  #formArea, #resultArea, #cgpaView {
    max-width: 800px;
    margin: auto;
  }

  /* Initially hide CGPA view */
  #cgpaView {
    display: none;
  }

  /* Print Formatting */
  @media print {
    body {
      background: white;
    }
    .toggle-btn, #formArea button, #printBtn, .nav-container, #cgpaView {
      display: none !important;
    }
    #gradeChart {
      display: none !important;
    }
    /* Ensure semester view is visible for printing */
    #semesterView {
      display: block !important;
    }
    #resultArea {
      box-shadow: none;
      margin-top: 0;
    }
    .student-box {
      page-break-inside: avoid;
      border: 1px solid #000;
      margin-bottom: 30px;
    }
    .student-box h3 {
      text-align: center;
      text-transform: uppercase;
      border-bottom: 1px solid #000;
      padding-bottom: 4px;
    }
    .gpa {
      text-align: right;
    }
  }
</style>
</head>
<body>

<!-- Navigation -->
<div class="nav-container">
  <button id="navToSemester" class="nav-btn" onclick="showView('semesterView')" style="display: none;">Semester GPA Calculator</button>
  <button id="navToCGPA" class="nav-btn" onclick="showView('cgpaView')">CGPA Calculator</button>
</div>

<!-- View 1: Semester GPA Calculator (Original Content) -->
<div id="semesterView">
  <h2>University GPA Calculator & Report</h2>

  <!-- Toggle Grade Chart -->
  <button class="toggle-btn" onclick="toggleChart()">See Grade Conversion Chart</button>

  <div class="grade-chart" id="gradeChart">
    <h3 style="text-align:center;">Grade Conversion Chart</h3>
    <table>
      <tr><th>Marks</th><th>Letter Grade</th><th>Grade Point</th></tr>
      <tr><td>80‚Äì100</td><td>A+</td><td>4.00</td></tr>
      <tr><td>75‚Äì79</td><td>A</td><td>3.75</td></tr>
      <tr><td>70‚Äì74</td><td>A‚Äì</td><td>3.50</td></tr>
      <tr><td>65‚Äì69</td><td>B+</td><td>3.25</td></tr>
      <tr><td>60‚Äì64</td><td>B</td><td>3.00</td></tr>
      <tr><td>55‚Äì59</td><td>B‚Äì</td><td>2.75</td></tr>
      <tr><td>50‚Äì54</td><td>C</td><td>2.50</td></tr>
      <tr><td>45‚Äì49</td><td>D</td><td>2.25</td></tr>
      <tr><td>Below 45</td><td>F</td><td>0.00</td></tr>
    </table>
  </div>

  <!-- Input Section -->
  <div style="text-align:center;" class="student-box">
    <label>Number of Students:</label>
    <input type="number" id="numStudents" min="1" value="1"><br>
    <label>Courses per Student:</label>
    <input type="number" id="numCourses" min="1" value="5"><br>
    <button onclick="createForm()">Generate Form</button>
  </div>

  <div id="formArea"></div>
  <div id="resultArea"></div>

  <!-- Print Button -->
  <div style="text-align:center;">
    <button id="printBtn" onclick="window.print()">üñ®Ô∏è Print Formal Report</button>
  </div>
</div>

<!-- View 2: CGPA Calculator (New Section) -->
<div id="cgpaView">
  <h2>CGPA Calculator (4.00 Scale)</h2>
  
  <div class="cgpa-box">
    <div style="text-align:center;">
      <label>Number of Semesters:</label>
      <input type="number" id="numSemesters" min="1" value="2"><br>
      <button onclick="createCGPAForm()">Generate Semester Fields</button>
    </div>
    
    <div id="cgpaFormArea"></div>
    
    <div id="cgpaResultArea"></div>
  </div>
</div>


<script>
// --- Common Functions ---
function gradePointFromLetter(letter) {
  switch (letter) {
    case "A+": return 4.00;
    case "A": return 3.75;
    case "A‚Äì": return 3.50;
    case "B+": return 3.25;
    case "B": return 3.00;
    case "B‚Äì": return 2.75;
    case "C": return 2.50;
    case "D": return 2.25;
    case "F": return 0.00;
    default: return null;
  }
}

function letterGrade(score) {
  if (score >= 80) return "A+";
  else if (score >= 75) return "A";
  else if (score >= 70) return "A‚Äì";
  else if (score >= 65) return "B+";
  else if (score >= 60) return "B";
  else if (score >= 55) return "B‚Äì";
  else if (score >= 50) return "C";
  else if (score >= 45) return "D";
  else return "F";
}

function grade(score) {
  if (score >= 80) return 4.00;
  else if (score >= 75) return 3.75;
  else if (score >= 70) return 3.50;
  else if (score >= 65) return 3.25;
  else if (score >= 60) return 3.00;
  else if (score >= 55) return 2.75;
  else if (score >= 50) return 2.50;
  else if (score >= 45) return 2.25;
  else return 0.00;
}

// --- View Toggling ---
function showView(viewId) {
  const semesterView = document.getElementById("semesterView");
  const cgpaView = document.getElementById("cgpaView");
  const navToSemester = document.getElementById("navToSemester");
  const navToCGPA = document.getElementById("navToCGPA");

  if (viewId === 'semesterView') {
    semesterView.style.display = "block";
    cgpaView.style.display = "none";
    navToSemester.style.display = "none";
    navToCGPA.style.display = "inline-block";
  } else {
    semesterView.style.display = "none";
    cgpaView.style.display = "block";
    navToSemester.style.display = "inline-block";
    navToCGPA.style.display = "none";
  }
}

function toggleChart() {
  const chart = document.getElementById("gradeChart");
  chart.style.display = (chart.style.display === "none" || chart.style.display === "") ? "block" : "none";
}

// --- Semester GPA Calculator Functions (Original) ---
function createForm() {
  const n = parseInt(document.getElementById("numStudents").value);
  const m = parseInt(document.getElementById("numCourses").value);
  const formArea = document.getElementById("formArea");
  formArea.innerHTML = "";

  for (let i = 0; i < n; i++) {
    let studentBox = document.createElement("div");
    studentBox.className = "student-box";
    studentBox.innerHTML = `
      <h3>Student ${i+1}</h3>
      Name: <input type="text" id="name${i}" placeholder="Enter name"><br>
      Registration No: <input type="number" id="reg${i}" placeholder="Reg no"><br>
      Institute: <input type="text" id="inst${i}" placeholder="Institute name"><br>
      Department: <input type="text" id="dept${i}" placeholder="Dept"><br>
      Semester: <input type="text" id="sem${i}" placeholder="e.g., 1st Semester"><br>
      Year: <input type="text" id="year${i}" placeholder="e.g., 2025"><br><br>
      <strong>Courses (${m})</strong><br>
      ${Array(m).fill(0).map((_, j) => `
        <div class="course-box">
          Course ${j+1}: <input type="text" id="course${i}_${j}" placeholder="Course name"><br>
          Credit: <input type="number" step="0.01" id="credit${i}_${j}" placeholder="Credit"><br>
          Obtained Marks: <input type="number" step="0.01" id="score${i}_${j}" placeholder="Marks" oninput="updateLetter(${i}, ${j})"><br>
          or Select Grade:
          <select id="gradeSel${i}_${j}">
            <option value="">--Select--</option>
            <option>A+</option><option>A</option><option>A‚Äì</option>
            <option>B+</option><option>B</option><option>B‚Äì</option>
            <option>C</option><option>D</option><option>F</option>
          </select>
        </div>
      `).join("")}
    `;
    formArea.appendChild(studentBox);
  }

  const calcButton = document.createElement("button");
  calcButton.textContent = "Calculate GPA";
  calcButton.style.display = "block"; // Make button block level
  calcButton.style.margin = "10px auto"; // Center the button
  calcButton.onclick = function() { calculateGPA(n, m); };
  formArea.appendChild(calcButton);
}

function updateLetter(i, j) {
  const score = parseFloat(document.getElementById(`score${i}_${j}`).value);
  const gradeSel = document.getElementById(`gradeSel${i}_${j}`);
  if (!isNaN(score)) gradeSel.value = letterGrade(score);
  else gradeSel.value = "";
}

function calculateGPA(n, m) {
  const resultArea = document.getElementById("resultArea");
  resultArea.innerHTML = "";

  for (let i = 0; i < n; i++) {
    let name = document.getElementById(`name${i}`).value || "Unnamed Student";
    let reg = document.getElementById(`reg${i}`).value || "N/A";
    let dept = document.getElementById(`dept${i}`).value || "N/A";
    let inst = document.getElementById(`inst${i}`).value || "N/A";
    let sem = document.getElementById(`sem${i}`).value || "N/A";
    let year = document.getElementById(`year${i}`).value || "N/A";

    let totalCredit = 0, creditXgpa = 0;
    let studentHTML = `<div class="student-box"><h3>${inst || 'University Report'}</h3>
    <p><strong>Name:</strong> ${name}<br>
    <strong>Reg No:</strong> ${reg}<br>
    <strong>Department:</strong> ${dept}<br>
    <strong>Semester:</strong> ${sem}<br>
    <strong>Year:</strong> ${year}</p>`;

    for (let j = 0; j < m; j++) {
      let course = document.getElementById(`course${i}_${j}`).value || `Course ${j+1}`;
      let credit = parseFloat(document.getElementById(`credit${i}_${j}`).value) || 0;
      let score = parseFloat(document.getElementById(`score${i}_${j}`).value);
      let letter = document.getElementById(`gradeSel${i}_${j}`).value;

      let g, l;
      if (letter) {
        g = gradePointFromLetter(letter);
        l = letter;
      } else if (!isNaN(score)) {
        g = grade(score);
        l = letterGrade(score);
      } else {
        g = 0;
        l = "N/A";
      }

      totalCredit += credit;
      creditXgpa += g * credit;

      studentHTML += `<div class="course-box">
        <strong>${course}</strong><br>
        Credit: ${credit.toFixed(2)} | Grade: ${l} (${g.toFixed(2)})
      </div>`;
    }

    let gpa = totalCredit > 0 ? (creditXgpa / totalCredit).toFixed(2) : "0.00";
    studentHTML += `<p class="gpa">Semester GPA: ${gpa}</p></div>`;
    resultArea.innerHTML += studentHTML;
  }
}

// --- CGPA Calculator Functions (New) ---
function createCGPAForm() {
  const numSemesters = parseInt(document.getElementById("numSemesters").value);
  const formArea = document.getElementById("cgpaFormArea");
  formArea.innerHTML = "";
  
  if (isNaN(numSemesters) || numSemesters < 1) {
    formArea.innerHTML = "<p style='color: red; text-align: center;'>Please enter a valid number of semesters.</p>";
    return;
  }

  for (let i = 0; i < numSemesters; i++) {
    let semBox = document.createElement("div");
    semBox.className = "semester-box";
    semBox.innerHTML = `
      <strong>Semester ${i+1}</strong><br>
      Total Credits: <input type="number" step="0.01" id="sem_credit_${i}" placeholder="e.g., 18.5"><br>
      Semester GPA (SGPA): <input type="number" step="0.01" id="sem_gpa_${i}" placeholder="e.g., 3.75">
    `;
    formArea.appendChild(semBox);
  }
  
  const calcButton = document.createElement("button");
  calcButton.textContent = "Calculate CGPA";
  calcButton.style.display = "block"; // Make button block level
  calcButton.style.margin = "10px auto"; // Center the button
  calcButton.onclick = calculateCGPA;
  formArea.appendChild(calcButton);
  
  // Clear previous result
  document.getElementById("cgpaResultArea").innerHTML = "";
}

function calculateCGPA() {
  const numSemesters = parseInt(document.getElementById("numSemesters").value);
  let totalCredits = 0;
  let totalGradePoints = 0;
  
  for (let i = 0; i < numSemesters; i++) {
    const credits = parseFloat(document.getElementById(`sem_credit_${i}`).value) || 0;
    const gpa = parseFloat(document.getElementById(`sem_gpa_${i}`).value) || 0;
    
    totalCredits += credits;
    totalGradePoints += (gpa * credits);
  }
  
  const cgpa = totalCredits > 0 ? (totalGradePoints / totalCredits) : 0;
  
  const resultArea = document.getElementById("cgpaResultArea");
  if (totalCredits === 0) {
     resultArea.innerHTML = `<p class="cgpa-result" style="color: red;">
      Please enter valid credit hours to calculate CGPA.
     </p>`;
  } else {
    resultArea.innerHTML = `<p class="cgpa-result">
      Total Credits: ${totalCredits.toFixed(2)}<br>
      Total Grade Points: ${totalGradePoints.toFixed(2)}<br>
      Your Cumulative GPA (CGPA) is: ${cgpa.toFixed(2)}
    </p>`;
  }
}

</script>
</body>
</html>
